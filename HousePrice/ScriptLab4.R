meanX <- mean(Price$sqft_living)
meanY <- mean(Price$price)
# –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î x
meanX
# –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Å–µ—Ä–µ–¥–Ω—î y
meanY


sd_X <- sd(Price$sqft_living)  
# –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è x
sd_X

sd_Y <- sd(Price$price) 
# –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è y
sd_Y

quantiles <- c(0.10, 0.25, 0.4, 0.5, 0.6, 0.75, 0.9) 
quant_X <- quantile(Price$sqft_living, quantiles) 
quant_Y <- quantile(Price$price, quantiles) 

# –∑—ñ–±—Ä–∞—Ç–∏ –≤—Å–µ –≤ data.frame 
DistributionSummary <- data.frame(Average = c(meanX, meanY),  
                                  StandardDeviation = c(sd_X, sd_Y),  
                                  quantile = rbind(quant_X, quant_Y)) 

# –≤–∏–≤–µ—Å—Ç–∏ —Ä–µ–∑—é–º–µ –Ω–∞ –∫–æ–Ω—Å–æ–ª—å 
DistributionSummary 

cor(Price$sqft_living, Price$price) 


linear_model <- lm(price ~ sqft_living, data = Price)
mod_summary <- summary(linear_model)

mod_summary

SSR <- sum(mod_summary$residuals^2)
TSS <- sum((Price$price - meanY)^2)
R2 <- 1 - SSR/TSS
# –≤–∏–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –∫–æ–Ω—Å–æ–ª—å
R2


# –æ–±—á–∏—Å–ª–∏—Ç–∏ SER –≤—Ä—É—á–Ω—É
n <- nrow(Price)
SER <- sqrt(SSR / (n-2))

# –≤–∏–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –∫–æ–Ω—Å–æ–ª—å
SER
#(A)–í–∏–∑–Ω–∞—á—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –ø–æ—Ö–∏–±–∫—É –¥–ª—è –æ—Ü—ñ–Ω–µ–Ω–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤
#Std. Error (Intercept) 4402.690
#Std. Error sqft_living  1.936

#(B) –í–∏–∑–Ω–∞—á—Ç–µ –¥–ª—è –≤–∞—à–æ–≥–æ –Ω–∞–±–æ—Ä—É —á–æ–º—É –¥–æ—Ä—ñ–≤–Ω—é—î ùë°–∫—Ä


qt(p=.05, df=21611, lower.tail=TRUE)

#(C) –í–∏–∑–Ω–∞—á—Ç–µ t-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ—Ü—ñ–Ω–µ–Ω–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ ùõΩ0 —Ç–∞ ùõΩ1 —Ç–∞ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –∞–Ω–∞–ª—ñ–∑ —á–∏  –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è ùêª0 —á–∏ –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ ùêª1


#(D) –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑–∏ ùêª0: ùõΩ0 = 0 –∞–±–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ—ó;


#(E) –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≥—ñ–ø–æ—Ç–µ–∑–∏ ùêª0: ùõΩ1 = 0 –∞–±–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ—ó;

#(F) –í–∏–∑–Ω–∞—á—Ç–µ —Å—Ç—É–ø–µ–Ω—ñ –≤—ñ–ª—å–Ω–æ—Å—Ç—ñ –¥–ª—è –≤–∞—à–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö;
#21611 degrees of freedom
linear_model$df.residual
#(G) –í–∏–∑–Ω–∞—á—Ç–µ Pr(>|t|) –¥–ª—è –æ—Ü—ñ–Ω–µ–Ω–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤
#(Intercept)   <2e-16 ***
#sqft_living   <2e-16 ***
2*pt(144.920, df = 21611) # Pr(>|t|) –¥–ª—è beta1
2 * pt(-9.899, df = 21611) # Pr(>|t|) –¥–ª—è beta0

pt(144.920, df = 21611,lower.tail = TRUE)
#(H) –û–±—á–∏—Å–ª—ñ—Ç—å 95% –¥–æ–≤—ñ—Ä—á–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤
confint(linear_model)
lm_summ <- summary(linear_model)

c("lower" = lm_summ$coef[2,1] - qt(0.975, df = lm_summ$df[2]) * lm_summ$coef[2, 2],
  "upper" = lm_summ$coef[2,1] + qt(0.975, df = lm_summ$df[2]) * lm_summ$coef[2, 2])



##############

# –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ—ñ–∫—Ç–∏–≤–Ω—É –∑–º—ñ–Ω–Ω—É, —è–∫ –≤–∏–∑–Ω–∞—á–µ–Ω–æ 
Price$D <- Price$sqft_living < 2079.9


plot(price ~ sqft_living, 
     data = Price,
     main = "Scatterplot of TestScore and STR", 
     xlab = "STR (X)",
     ylab = "Test Score (Y)")

# –ü–æ–±—É–¥—É–π—Ç–µ –¥–∞–Ω—ñ
plot(Price$D, Price$price,            # –Ω–∞–¥–∞—Ç–∏ –¥–∞–Ω—ñ –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –≥—Ä–∞—Ñ—ñ–∫–∞
     pch = 20,                                # –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ –∫—Ä—É–∂–µ—á–∫–∏ —è–∫ —Å–∏–º–≤–æ–ª–∏ —Å—é–∂–µ—Ç—É
     cex = 0.5,                               # –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Å–∏–º–≤–æ–ª—ñ–≤ –≥—Ä–∞—Ñ—ñ–∫–∞ –Ω–∞ 0,5
     col = "Steelblue",                       # –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–ª—ñ—Ä —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–∞ "Steelblue"
     xlab = expression(D[i]),                 # –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–∞ –Ω–∞–∑–≤–∏ –æ—Å—ñ
     ylab = "Price",
     main = "Dummy Regression")

# –æ—Ü—ñ–Ω–∏—Ç–∏ —Ñ—ñ–∫—Ç–∏–≤–Ω—É —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—É –º–æ–¥–µ–ª—å
dummy_model <- lm(price ~ D, data = Price)
summary(dummy_model)

# –¥–æ–¥–∞–π—Ç–µ –¥–æ —Å—é–∂–µ—Ç—É –ø—Ä–æ–≥–Ω–æ–∑–∏ –¥–ª—è –ø–µ–≤–Ω–æ—ó –≥—Ä—É–ø–∏
points(x = Price$D, 
       y = predict(dummy_model), 
       col = "red", 
       pch = 20)
# –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏ –¥–ª—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ —É –º–æ–¥–µ–ª—ñ —Ñ—ñ–∫—Ç–∏–≤–Ω–æ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó
confint(dummy_model)

#–ó–∞–≤–¥–∞–Ω–Ω—è 4: –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –Ω–∞ –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å —á–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω—ñ—Å—Ç—å.
#(A) –°–∫–∞–∂—ñ—Ç—å, –¥–∏–≤–ª—è—á–∏—Å—å –Ω–∞ –¥—ñ–∞–≥—Ä–∞–º—É —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è, –≤–∞—à–µ –ø–æ—á–∞—Ç–∫–æ–≤–µ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è –≥–æ–º–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–µ —á–∏ –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–µ;



#(B) –û–±—á–∏—Å–ª–∏—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–º–∏–ª–∫–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤, —è–∫ –¥–ª—è –≥–µ—Ç–µ—Ä–æ—Å–∫–µ–¥–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑—Å—ñ—é–≤–∞–Ω–Ω—è
#–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é vcovHC() —Ç–∞ sqrt(diag()), —Ç–∞ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ –∑ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–∏–º –æ–±—á–∏—Å–ª–µ–Ω–Ω—è–º –∑–∞ 
#–¥–æ–ø–æ–º–æ–≥–æ—é coeftest( *, vcov. = vcov);